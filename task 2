from PIL import Image
import os

def encrypt_image(image_path, key):
    img = Image.open(image_path)
    pixels = img.load()
    width, height = img.size

    for x in range(width):
        for y in range(height):
            r, g, b = pixels[x, y]
            
            # Encrypting by swapping Red and Blue channels 
            # and applying XOR operation with key
            encrypted_pixel = (b ^ key, g ^ key, r ^ key)
            
            pixels[x, y] = encrypted_pixel

    img.save("encrypted_image.png")
    print("Image encrypted and saved as 'encrypted_image.png'")

def decrypt_image(image_path, key):
    img = Image.open(image_path)
    pixels = img.load()
    width, height = img.size

    for x in range(width):
        for y in range(height):
            r, g, b = pixels[x, y]
            
            # Reversing the operation
            decrypted_pixel = (b ^ key, g ^ key, r ^ key)
            
            pixels[x, y] = decrypted_pixel

    img.save("decrypted_image.png")
    print("Image decrypted and saved as 'decrypted_image.png'")

# Main execution
if __name__ == "__main__":
    # Ensure you have an image named 'input.jpg' in the same directory
    key = 123  # Simple integer key
    choice = input("Type 'encrypt' or 'decrypt': ").lower()
    
    if choice == 'encrypt':
        encrypt_image("input.jpg", key)
    elif choice == 'decrypt':
        decrypt_image("encrypted_image.png", key)
